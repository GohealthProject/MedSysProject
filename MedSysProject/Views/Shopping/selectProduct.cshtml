@model CProductWarp
@{
    ViewData["Title"] = "selectProduct";
    Layout = "~/Views/Shared/_Layout_Shopping.cshtml";
    string s = Model.UnitPrice.ToString();
}
<section class="breadcrumbs">
    <div class="container">

        <div class="d-flex justify-content-between align-items-center">
            <h2>產品規格</h2>
            <ol>
                <li><a asp-action="index">主頁</a></li>
                <li><a asp-action="Search" asp-route-id="@Model.Product.ProductsClassifications.FirstOrDefault().Categories.CategoriesId">@Model.Product.ProductsClassifications.FirstOrDefault().Categories.CategoriesName</a></li>
                <li>產品規格</li>
            </ol>
        </div>

    </div>
</section><!-- Breadcrumbs -->
<!-- ======= Portfolio Details Section ======= -->
<section id="portfolio-details" class="portfolio-details">
    <div class="container">

        <div class="row gy-4">

            <div class="col-lg-8">
                <div class="portfolio-details-slider swiper">
                    <div class="swiper-wrapper align-items-center">
                        @{
                            foreach(var img in Model.Path)
                            {
                                <div class="swiper-slide">
                                    <img src="@Url.Content("~/img-product/")@Model.Path[0]" alt="">
                                </div>
                            }
                        } 
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="portfolio-info">
                    <h3 class="fs-2">@Model.ProductName</h3>
                    <ul>
                        <li class="fs-4"><strong>分類</strong>: Web design</li>
                        <li class="fs-4"><strong>出貨商</strong>: ASU Company</li>
                        <li class="fs-4"><strong>產品價格</strong><span class="text-danger">    $@s.TrimEnd('0').TrimEnd('.')</span></li>
                        <li class="fs-4"><strong>證號</strong>: <a href="#">@Model.License</a></lic>
                    </ul>
                </div>
                <div class="portfolio-description">
                    <h2>@Model.License</h2>
                    <p class="fs-3">
                        @Model.Description
                    </p>
                    
                    <p>
                        <form  id="datas">
                            <select name="count" class="form-select" style="display:inline ; width:200px" >
                                @{
                                    for(int i = 1; i <= Model.UnitsInStock; i++)
                                    {
                                        <option value="@i">@i</option>
                                        if (i >= 50)
                                        {
                                            <option>...</option>
                                            break;
                                        }
                                    }
                                }
                                }
                        </select>
                        <input type="hidden" value="@Model.ProductId" name="id"/>
                        <input type="checkbox" />
                        <button class="btn btn-info" onclick="addToCart(event)">加入購物車</button>
                        </form>
                    </p>
                </div>
            </div>

        </div>

    </div>
</section><!-- End Portfolio Details Section -->
@section Scripts{
    <script>
        const item = document.querySelector("#datas");
        var data = new FormData(item);
        
        async function addToCart(event){
            event.preventDefault()
            var data = new FormData(item);
            const response = await fetch("@Url.Content("~/Shopping/AddToCart")",{
                body: data,
                method:"POST",
            })
            const re = await response.text();
            getcartList()
            alert("加入購物車成功");
        }
        
        function changeImg(imgElement) {
            $("#imgList>img").css("border", "");
            const src = imgElement.src;
            document.querySelector("#mainImg").src = src;
            imgElement.style.border = "1px dashed red";
        }
    </script>
}