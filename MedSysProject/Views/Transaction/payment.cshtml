@model System.Collections.Generic.Dictionary<string, string>
@{
    Layout = null;
}
<!DOCTYPE html>
<html>
<body>
    <h1>@Url.Content("~/Home/Test");</h1>
    <div>
        卡號:4311-9522-2222-2222
        CVC:222
        expire: 01/24
    </div>
    <form id="form" name="form" method="POST" action="https://payment-stage.ecpay.com.tw/Cashier/AioCheckOut/V5">
        <!--step2 : 收到後端的值印出來-->
        @foreach (var key in @Model.Keys.ToList())
        {
            @(key) <input type="text" name="@key" value="@Model[key]" />

            <br />
        }
        <button type="submit" id="checkoutBtn">送出</button>
    </form>
    <button class="btn btn-danger" id="ttest">123</button>
    <!-- js套件 -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-twzipcode@1.7.14/jquery.twzipcode.min.js"></script>
    <!-- 自己的 -->
    @* <script src="../../assets/js/ecpay.js"></script>*@

    @*呼叫ACTION將訂單存入資料庫*@
    <script>
        $("#checkoutBtn").on('click', (e) => {
            //e.preventDefault(); //因為送出就跳轉到綠界，這個可以停住確認自己的console.log的內容
            let formData = $("#form").serializeArray();
            var json = {};
            $.each(formData, function () {
                json[this.name] = this.value || "";
            });
            console.log(json);
            //step3 : 新增訂單到資料庫
            $.ajax({
                type: 'POST',
                url: 'https://localhost:7203/Transaction/addOrders',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(json),
                success: function (res) {
                    console.log(res);
                },
                error: function (err) { console.log(err); },
            });
        });
        $("#ttest").on('click', (e) =>{
            //e.preventDefault(); //因為送出就跳轉到綠界，這個可以停住確認自己的console.log的內容
            let formData = $("#form").serializeArray();
            var json = {};
            $.each(formData, function () {
                json[this.name] = this.value || "";
            });
            console.log(json);
            //step3 : 新增訂單到資料庫
            $.ajax({
                type: 'POST',
                url: 'https://localhost:7203/Transaction/addOrders',
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(json),
                success: function (res) {
                    console.log(res);
                },
                error: function (err) { console.log(err); },
            });
            $("#form").submit();
        })

    </script>
</body>

</html>